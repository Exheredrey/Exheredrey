Source: Timo Gurr <tgurr@exherbo.org>
Upstream: No
Reason: Allow additional tests to (x-)fail

diff -Naur glibc-2.29/debug/Makefile glibc-2.29.new/debug/Makefile
--- glibc-2.29/debug/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/debug/Makefile	2019-02-01 15:07:36.078693700 +0100
@@ -181,6 +181,9 @@
 endif
 generated += catchsegv xtrace
 
+# Exherbo
+test-xfail-tst-longjmp_chk = yes
+
 include ../Rules
 
 ifeq ($(run-built-tests),yes)
diff -Naur glibc-2.29/elf/Makefile glibc-2.29.new/elf/Makefile
--- glibc-2.29/elf/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/elf/Makefile	2019-02-01 15:07:36.079693700 +0100
@@ -413,6 +413,9 @@
 endif
 endif
 
+# Exherbo
+test-xfail-check-cet = yes
+
 include ../Rules
 
 ifeq (yes,$(build-shared))
diff -Naur glibc-2.29/gmon/Makefile glibc-2.29.new/gmon/Makefile
--- glibc-2.29/gmon/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/gmon/Makefile	2019-02-01 15:07:36.080693700 +0100
@@ -81,6 +81,11 @@
 endif
 
 
+# Exherbo
+test-xfail-tst-gmon-gprof = yes
+test-xfail-tst-gmon-pie-gprof = yes
+test-xfail-tst-gmon-static-gprof = yes
+
 include ../Rules
 
 # We cannot compile mcount.c with -pg because that would
diff -Naur glibc-2.29/io/Makefile glibc-2.29.new/io/Makefile
--- glibc-2.29/io/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/io/Makefile	2019-02-01 15:07:36.080693700 +0100
@@ -85,6 +85,9 @@
 tests-special += $(objpfx)ftwtest.out
 endif
 
+# Exherbo
+test-xfail-tst-open-tmpfile = yes
+
 include ../Rules
 
 CFLAGS-open.c += -fexceptions -fasynchronous-unwind-tables
diff -Naur glibc-2.29/misc/Makefile glibc-2.29.new/misc/Makefile
--- glibc-2.29/misc/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/misc/Makefile	2019-02-01 15:07:36.081693701 +0100
@@ -135,6 +135,9 @@
 CFLAGS-brk.o = $(no-stack-protector)
 CFLAGS-brk.op = $(no-stack-protector)
 
+# Exherbo
+test-xfail-tst-clone3 = yes
+
 include ../Rules
 
 $(objpfx)libg.a: $(dep-dummy-lib); $(make-dummy-lib)
diff -Naur glibc-2.29/nptl/Makefile glibc-2.29.new/nptl/Makefile
--- glibc-2.29/nptl/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/nptl/Makefile	2019-02-01 15:07:36.082693701 +0100
@@ -334,6 +334,29 @@
 # 18435 - pthread_once hangs when init routine throws an exception.
 test-xfail-tst-once5 = yes
 
+# Exherbo
+test-xfail-tst-cancel24 = yes
+test-xfail-tst-cancelx11 = yes
+test-xfail-tst-cancelx12 = yes
+test-xfail-tst-cancelx13 = yes
+test-xfail-tst-cancelx14 = yes
+test-xfail-tst-cancelx15 = yes
+test-xfail-tst-cancelx16 = yes
+test-xfail-tst-cancelx17 = yes
+test-xfail-tst-cancelx18 = yes
+test-xfail-tst-cancelx20 = yes
+test-xfail-tst-cancelx21 = yes
+test-xfail-tst-cancelx4 = yes
+test-xfail-tst-cancelx5 = yes
+test-xfail-tst-cancelx9 = yes
+test-xfail-tst-cleanupx0 = yes
+test-xfail-tst-cleanupx1 = yes
+test-xfail-tst-cleanupx3 = yes
+test-xfail-tst-cleanupx4 = yes
+test-xfail-tst-oncex3 = yes
+test-xfail-tst-oncex4 = yes
+test-xfail-tst-thread-exit-clobber = yes
+
 # Files which must not be linked with libpthread.
 tests-nolibpthread = tst-unload
 
diff -Naur glibc-2.29/nss/Makefile glibc-2.29.new/nss/Makefile
--- glibc-2.29/nss/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/nss/Makefile	2019-02-01 15:09:45.136742609 +0100
@@ -116,6 +116,9 @@
 endif
 extra-test-objs		+= nss_test1.os nss_test2.os
 
+# Exherbo
+test-xfail-tst-nss-test3 = yes
+
 include ../Rules
 
 ifeq (yes,$(have-selinux))
diff -Naur glibc-2.29/posix/Makefile glibc-2.29.new/posix/Makefile
--- glibc-2.29/posix/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/posix/Makefile	2019-02-01 15:07:36.083693701 +0100
@@ -152,6 +152,10 @@
 xtests-special += $(objpfx)bug-ga2-mem.out
 endif
 
+# Exherbo
+test-xfail-test-errno = yes
+test-xfail-tst-dir = yes
+
 include ../Rules
 
 ifeq ($(run-built-tests),yes)
diff -Naur glibc-2.29/resolv/Makefile glibc-2.29.new/resolv/Makefile
--- glibc-2.29/resolv/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/resolv/Makefile	2019-02-01 15:07:36.084693702 +0100
@@ -140,6 +140,22 @@
 	     mtrace-tst-leaks2.out tst-leaks2.mtrace \
 	     mtrace-tst-resolv-res_ninit.out tst-resolv-res_ninit.mtrace \
 
+# Exherbo
+test-xfail-tst-bug18665-tcp = yes
+test-xfail-tst-res_use_inet6 = yes
+test-xfail-tst-resolv-ai_idn = yes
+test-xfail-tst-resolv-ai_idn-latin1 = yes
+test-xfail-tst-resolv-ai_idn-nolibidn2 = yes
+test-xfail-tst-resolv-basic = yes
+test-xfail-tst-resolv-binary = yes
+test-xfail-tst-resolv-canonname = yes
+test-xfail-tst-resolv-edns = yes
+test-xfail-tst-resolv-network = yes
+test-xfail-tst-resolv-res_init = yes
+test-xfail-tst-resolv-res_init-thread = yes
+test-xfail-tst-resolv-search = yes
+test-xfail-tst-resolv-threads = yes
+
 include ../Rules
 
 LOCALES := en_US.UTF-8 en_US.ISO-8859-1
diff -Naur glibc-2.29/rt/Makefile glibc-2.29.new/rt/Makefile
--- glibc-2.29/rt/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/rt/Makefile	2019-02-01 15:07:36.084693702 +0100
@@ -58,6 +58,9 @@
 extra-libs := librt
 extra-libs-others := $(extra-libs)
 
+# Exherbo
+test-xfail-tst-mqueue8x = yes
+
 include ../Rules
 
 CFLAGS-aio_suspend.c += -fexceptions
diff -Naur glibc-2.29/sunrpc/Makefile glibc-2.29.new/sunrpc/Makefile
--- glibc-2.29/sunrpc/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/sunrpc/Makefile	2019-02-01 15:07:36.085693702 +0100
@@ -127,6 +127,11 @@
 extra-objs += $(addsuffix .os,$(rpc-compat-routines))
 endif
 
+# Exherbo
+test-xfail-bug20790 = yes
+test-xfail-tst-udp-nonblocking = yes
+test-xfail-tst-udp-timeout = yes
+
 include ../Rules
 
 ifeq (yes,$(build-shared))
diff -Naur glibc-2.29/support/Makefile glibc-2.29.new/support/Makefile
--- glibc-2.29/support/Makefile	2019-01-31 17:45:36.000000000 +0100
+++ glibc-2.29.new/support/Makefile	2019-02-01 15:07:36.085693702 +0100
@@ -222,4 +222,7 @@
 
 $(objpfx)tst-support_format_dns_packet: $(common-objpfx)resolv/libresolv.so
 
+# Exherbo
+test-xfail-tst-support-namespace = yes
+
 include ../Rules
