# Copyright 2009 Ingmar Vanhassel <ingmar@exherbo.org>
# Distributed under the terms of the GNU General Public License v2

require wafsamba

SUMMARY="A hierarchical pool based memory allocator with destructors"
DESCRIPTION="
Talloc is a hierarchical pool based memory allocator with destructors. It is the core memory
allocator used in Samba, and has made a huge difference in many aspects of Samba4 development.
"
HOMEPAGE="https://${PN}.samba.org"
DOWNLOADS="https://samba.org/ftp/${PN}/${PNV}.tar.gz"

LICENCES="LGPL-3"
SLOT="0"
PLATFORMS="~amd64 ~armv7 ~armv8 ~x86"
MYOPTIONS=""

DEPENDENCIES="
    build+run:
        dev-libs/libbsd [[ note = [ automagic ] ]]
"

WAF_SRC_COMPILE_PARAMS=( -j1 )

DEFAULT_SRC_INSTALL_EXCLUDE=( release-script.sh )

src_install() {
    waf_src_install

    dosym /usr/$(exhost --target)/lib/{libtalloc.so.${PV},libtalloc.so}
}

